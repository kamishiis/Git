\chapter{評価実験}
本研究で実装した検知システムにおける定常的な動作負荷の評価を行い，DDoS攻撃を行うマルウェアを用いて検知精度の評価を行った．

\section{システムコール呼び出し履歴を用いた検知手法による定常的な動作負荷の評価}

IoTデバイスにマルウェアが動作していない状況下において，提案した検知システムによるマルウェア探索動作によってIoTデバイス本来の動作が阻害されていないことを評価するために，3.4節で述べたように，LinuxOSを対象とする既存のアンチウィルスソフトであるClam AVを動作させた状態のCPU，メモリの使用率を基準値とし，提案した検知システムによってMiraiが動作していない状況での，CPU，メモリの使用率についてsarコマンドを用いて1分間計測を行った．
sarコマンドを用いて得たCPU，メモリの使用率について，Clam AVと比較を行った結果が図○，○になる．
 
\begin{figure}[h]
    \centering
       \includegraphics[width=120mm]{figures/test.eps}
    \label{fig:model}
        \begin{center}図○　IoTデバイス上でマルウェアが動作していない状況におけるマルウェア探索のメモリ使用率\end{center}
\end{figure}
  
\begin{figure}[h]
        \centering
           \includegraphics[width=120mm]{figures/test.eps}
        \label{fig:model}
        \begin{center}図○　IoTデバイス上でマルウェアが動作していない状況におけるマルウェア探索のCPU使用率\end{center}
\end{figure}
   
 Clam AntiVirusを利用した場合には，平均CPU使用率が○\%，メモリ使用率は○\%となった．提案した検知手法では，平均CPU使用率が○\%，メモリ使用率が○\%となった．メモリ使用率は比較対象のClam AntiVirusと提案した検知手法では○\%減，CPU使用率は，Clam AntiVirusに対して提案した検知手法は○\%減となった


\section{Miraiとその亜種マルウェアを対象とする判別性能評価}
ハニーポットを用いてDDoS攻撃を行うマルウェアを収集し，収集したマルウェアを検体として用いて，システムコール呼び出し履歴を用いた検知手法の検知精度の評価を行った．

\subsection{ハニーポットによるマルウェアの収集}
ハニーポットと呼ばれる攻撃者に端末を意図的に侵入させ，マルウェアをダウンロードさせ実行するまでの挙動を取得するシステムを用いてDDoS攻撃を行うマルウェアを収集した．シェルの対話の中でダウンロードされるバイナリファイルを実行させることなく保存することが可能なMichel Oosterhofによって開発されたCowrie\cite{Cowrie}と呼ばれるハニーポットを用いた．Cowrieによって収集されたバイナリファイルについてVirus Totalと呼ばれるマルウェア検知オンラインサービスを用いて解析を行い，DDoS攻撃を行うマルウェアの分類分けを行った．Virus Total\cite{Virus}はユーザーから投稿された検体を54のウィルス対策エンジンによって解析するオンラインサービスであり，投稿された検体についてマルウェアの分類を知ることができる．2019/01/09から2019/01/28の期間でハニーポットを断続的に運用してバイナリファイルの収集を行った．収集したバイナリファイルをVirus Totalに投稿し，Virus Totalの解析結果から，MiraiまたはMiraiの亜種のマルウェアをDDoS攻撃を行うマルウェアとして分類分けした．分析した結果，収集したバイナリファイルは，空ファイルのものや，マルウェアをダウンロードさせ実行させるファイル，DDoS攻撃を行うマルウェアのバイナリファイル等が散見され，DDoS攻撃を行うマルウェアは57検体が存在し，マルウェアの実行可能な検体は49検体であった．

\subsection{提案システムによるマルウェアの検知精度評価}
前項で収集した49検体のDDoS攻撃を行うマルウェアを用いてシステムコール呼び出し履歴を用いた検知手法の検知精度の評価を行った．入手したマルウェアをネットワークから隔離した状態で検知システムを動作させマルウェアの検知できるか評価を行った．正規プログラムは，Linuxに標準でインストールされている44検体を利用した．実験の評価指数として，Accuracy，TPR(True Positive Rate)，TNR(True Negative Rate)，FPR(False Positive Rate)，FNR(False Negative Rate)を用いる．Accuracyは，マルウェアを正しく判別できた割合である．TPRはマルウェアをマルウェアと判別できた割合，TNRは正規プログラムを正規プログラムと判別した割合，FPRはマルウェアを正規プログラムと判別した割合，FPRは正規プログラムをマルウェアとして判別した割合である．Accuracy，TPR，TNR，FPR，FNRを下記の式で算出する．

\begin{eqnarray}
    Accuracy & = & \frac{正しくマルウェアと判別された検体数}{検体の総数}\\
    TPR & = & \frac{マルウェア検体がマルウェアと判別された検体数}{マルウェア検体の総数}\\
    TNR & = & \frac{正規プログラムを正規プログラムとして判別された検体数}{正規プログラムの総数}\\
    FNR & = & \frac{マルウェア検体が正規プログラムとして判別された検体数}{マルウェア検体の総数}\\ 
    FPR & = & \frac{正規プログラムをマルウェアとして判別された検体数}{正規プログラムの総数}
\end{eqnarray}

提案システムによるプログラムの判別結果を表6に示し，Accuracy，TPR，TNR，FPR，FNRの結果を表10に示す．

